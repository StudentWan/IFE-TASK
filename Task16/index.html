<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .stage {
            width: 600px;
            height: 600px;
            border: 1px solid black;
            margin: 10px auto;
            box-sizing: content-box;
            position: relative;
        }

        [class*='grid-'] {
            box-sizing: border-box;
            width: 60px;
            height: 60px;
            border: 1px solid lightgrey;
            float: left;
        }

        .column:before {
        }

        .column {
            width: 600px;
            margin: 0 auto;
        }

        .column:after {
            content: "";
            display: table;
            clear: both;
        }

        .column div {
            width: 60px;
            float: left;
            text-align: center;
        }

        .row {
            position: absolute;
            height: 600px;
        }

        .row div {
            height: 60px;
            line-height: 60px;
            white-space: nowrap;
            margin-left: -35px;
        }

        #cubic {
            box-sizing: border-box;
            width: 60px;
            height: 60px;
            background: red;
            border-right: 10px solid blue;
            position: absolute;
            transition: transform 1s;
        }

        .control {
            width: 600px;
            margin: 5px auto;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="column">
    <div class="1">1</div>
    <div class="2">2</div>
    <div class="3">3</div>
    <div class="4">4</div>
    <div class="5">5</div>
    <div class="6">6</div>
    <div class="7">7</div>
    <div class="8">8</div>
    <div class="9">9</div>
    <div class="10">10</div>
</div>
<div class="stage">
    <div id="cubic" title="0"></div>
    <div class="row">
        <div class="1">1</div>
        <div class="2">2</div>
        <div class="3">3</div>
        <div class="4">4</div>
        <div class="5">5</div>
        <div class="6">6</div>
        <div class="7">7</div>
        <div class="8">8</div>
        <div class="9">9</div>
        <div class="10">10</div>
    </div>
    <div class="grid-11"></div>
    <div class="grid-12"></div>
    <div class="grid-13"></div>
    <div class="grid-14"></div>
    <div class="grid-15"></div>
    <div class="grid-16"></div>
    <div class="grid-17"></div>
    <div class="grid-18"></div>
    <div class="grid-19"></div>
    <div class="grid-20"></div>
    <div class="grid-21"></div>
    <div class="grid-22"></div>
    <div class="grid-23"></div>
    <div class="grid-24"></div>
    <div class="grid-25"></div>
    <div class="grid-26"></div>
    <div class="grid-27"></div>
    <div class="grid-28"></div>
    <div class="grid-29"></div>
    <div class="grid-30"></div>
    <div class="grid-31"></div>
    <div class="grid-32"></div>
    <div class="grid-33"></div>
    <div class="grid-34"></div>
    <div class="grid-35"></div>
    <div class="grid-36"></div>
    <div class="grid-37"></div>
    <div class="grid-38"></div>
    <div class="grid-39"></div>
    <div class="grid-40"></div>
    <div class="grid-41"></div>
    <div class="grid-42"></div>
    <div class="grid-43"></div>
    <div class="grid-44"></div>
    <div class="grid-45"></div>
    <div class="grid-46"></div>
    <div class="grid-47"></div>
    <div class="grid-48"></div>
    <div class="grid-49"></div>
    <div class="grid-50"></div>
    <div class="grid-51"></div>
    <div class="grid-52"></div>
    <div class="grid-53"></div>
    <div class="grid-54"></div>
    <div class="grid-55"></div>
    <div class="grid-56"></div>
    <div class="grid-57"></div>
    <div class="grid-58"></div>
    <div class="grid-59"></div>
    <div class="grid-60"></div>
    <div class="grid-61"></div>
    <div class="grid-62"></div>
    <div class="grid-63"></div>
    <div class="grid-64"></div>
    <div class="grid-65"></div>
    <div class="grid-66"></div>
    <div class="grid-67"></div>
    <div class="grid-68"></div>
    <div class="grid-69"></div>
    <div class="grid-70"></div>
    <div class="grid-71"></div>
    <div class="grid-72"></div>
    <div class="grid-73"></div>
    <div class="grid-74"></div>
    <div class="grid-75"></div>
    <div class="grid-76"></div>
    <div class="grid-77"></div>
    <div class="grid-78"></div>
    <div class="grid-79"></div>
    <div class="grid-80"></div>
    <div class="grid-81"></div>
    <div class="grid-82"></div>
    <div class="grid-83"></div>
    <div class="grid-84"></div>
    <div class="grid-85"></div>
    <div class="grid-86"></div>
    <div class="grid-87"></div>
    <div class="grid-88"></div>
    <div class="grid-89"></div>
    <div class="grid-90"></div>
    <div class="grid-91"></div>
    <div class="grid-92"></div>
    <div class="grid-93"></div>
    <div class="grid-94"></div>
    <div class="grid-95"></div>
    <div class="grid-96"></div>
    <div class="grid-97"></div>
    <div class="grid-98"></div>
    <div class="grid-99"></div>
    <div class="grid-100"></div>
    <div class="grid-101"></div>
    <div class="grid-102"></div>
    <div class="grid-103"></div>
    <div class="grid-104"></div>
    <div class="grid-105"></div>
    <div class="grid-106"></div>
    <div class="grid-107"></div>
    <div class="grid-108"></div>
    <div class="grid-109"></div>
    <div class="grid-110"></div>
</div>
<div class="control">
    <p>
        <button id="go">GO</button>
        <button id="tun_lef">TUN LEF</button>
        <button id="tun_rig">TUN RIG</button>
        <button id="tun_bac">TUN BAC</button>
    </p>
    <p>
        <button id="tra_lef">TRA LEF</button>
        <button id="tra_top">TRA TOP</button>
        <button id="tra_rig">TRA RIG</button>
        <button id="tra_bot">TRA BOT</button>
    </p>
    <p>
        <button id="mov_lef">MOV LEF</button>
        <button id="mov_top">MOV TOP</button>
        <button id="mov_rig">MOV RIG</button>
        <button id="mov_bot">MOV BOT</button>
    </p>
</div>
<script>
    const go = document.getElementById('go'),
        tunLef = document.getElementById('tun_lef');
    tunRig = document.getElementById('tun_rig');
    tunBac = document.getElementById('tun_bac');
    traLef = document.getElementById('tra_lef');
    traTop = document.getElementById('tra_top');
    traRig = document.getElementById('tra_rig');
    traBot = document.getElementById('tra_bot');
    movLef = document.getElementById('mov_lef');
    movTop = document.getElementById('mov_top');
    movRig = document.getElementById('mov_rig');
    movBot = document.getElementById('mov_bot');

    cubic = document.getElementById('cubic');
    let positionX = 0, positionY = 0, angle = 0;
    direction = parseInt(cubic.title);

    go.onclick = () => {
        direction = parseInt(cubic.title);
        switch (direction) {
            case 0:
                if (positionX < 540) {
                    positionX += 60;
                    rotateAndMove();
                }
                break;
            case 1:
                if (positionY < 540) {
                    positionY += 60;
                    rotateAndMove();
                }
                break;
            case 2:
                if (positionX > 0) {
                    positionX -= 60;
                    rotateAndMove();
                }
                break;
            case 3:
                if (positionY > 0) {
                    positionY -= 60;
                    rotateAndMove();
                }
                break;
            default:
                break;
        }
    };

    tunLef.onclick = () => {
        cubic.setAttribute('title', ((direction + 3) % 4).toString());
        direction = (parseInt(cubic.title));
        angle -= 90;
        rotateAndMove();
    };

    tunRig.onclick = () => {
        cubic.setAttribute('title', ((direction + 1) % 4).toString());
        direction = (parseInt(cubic.title));
        angle += 90;
        rotateAndMove();
    };

    tunBac.onclick = () => {
        cubic.setAttribute('title', ((direction + 2) % 4).toString());
        direction = (parseInt(cubic.title));
        angle += 180;
        rotateAndMove();
    };

    traLef.onclick = () => {
        if (positionX > 0) {
            positionX -= 60;
            rotateAndMove();
        }
    };

    traTop.onclick = () => {
        if (positionY > 0) {
            positionY -= 60;
            rotateAndMove();
        }
    };

    traRig.onclick = () => {
        if (positionX < 540) {
            positionX += 60;
            rotateAndMove();
        }
    };

    traBot.onclick = () => {
        if (positionY < 540) {
            positionY += 60;
            rotateAndMove();
        }
    };

    movLef.onclick = () => {
        cubic.setAttribute('title', '2');
        direction = (parseInt(cubic.title));
        let angleNow = ((angle % 360 + 360) / 90) % 4;
        switch (angleNow) {
            case 0:
                angle += 180;
                break;
            case 1:
                angle += 90;
                break;
            case 2:
                break;
            case 3:
                angle -= 90;
                break;
            default:
                break;
        }
        rotateAndMove();
        if (positionX > 0) {
            positionX -= 60;
            if (angleNow !== 2) {
                setTimeout(() => {
                    rotateAndMove();
                }, 1000)
            } else {
                rotateAndMove();
            }
        }
    };

    movTop.onclick = () => {
        cubic.setAttribute('title', '3');
        direction = (parseInt(cubic.title));
        let angleNow = ((angle % 360 + 360) / 90) % 4;
        console.log(angleNow);
        switch (angleNow) {
            case 0:
                angle -= 90;
                break;
            case 1:
                angle += 180;
                break;
            case 2:
                angle += 90;
                break;
            case 3:
                break;
            default:
                break;
        }
        rotateAndMove();
        if (positionY > 0) {
            positionY -= 60;
            if (angleNow !== 3) {
                setTimeout(() => {
                    rotateAndMove();
                }, 1000)
            } else {
                rotateAndMove();
            }
        }
    };

    movRig.onclick = () => {
        cubic.setAttribute('title', '0');
        direction = (parseInt(cubic.title));
        let angleNow = ((angle % 360 + 360) / 90) % 4;
        switch (angleNow) {
            case 0:
                break;
            case 1:
                angle -= 90;
                break;
            case 2:
                angle += 180;
                break;
            case 3:
                angle += 90;
                break;
            default:
                break;
        }
        rotateAndMove();
        if (positionX < 540) {
            positionX += 60;
            if (angleNow !== 0) {
                setTimeout(() => {
                    rotateAndMove();
                }, 1000)
            } else {
                rotateAndMove();
            }
        }
    };

    movBot.onclick = () => {
        cubic.setAttribute('title', '1');
        direction = (parseInt(cubic.title));
        let angleNow = ((angle % 360 + 360) / 90) % 4;
        switch (angleNow) {
            case 0:
                angle += 90;
                break;
            case 1:
                break;
            case 2:
                angle -= 90;
                break;
            case 3:
                angle += 180;
                break;
            default:
                break;
        }
        rotateAndMove();
        if (positionY < 540) {
            positionY += 60;
            if (angleNow !== 1) {
                setTimeout(() => {
                    rotateAndMove();
                }, 1000)
            }
        } else {
            rotateAndMove();
        }
    };

    function rotateAndMove() {
        cubic.style.transform = 'translateX(' + positionX + 'px)' + 'translateY(' + positionY + 'px)' + 'rotate(' + angle + 'deg) ';
    }

</script>
</body>
</html>